<!-------------------------------------------------------------------------------------
*
* MIT License
* Copyright (c) 2020 Raghuveer S
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
------------------------------------------------------------------------------------>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta content="Knowledge Continuum" property="og:site_name"/>
    <meta content="A non-linear thread of important ideas weaved together to explore and understand the fabric of knowledge." property="og:description">
    <meta content="https://simply-jekyll.netlify.app//about/" property="article:author"><meta content="Basics of Phylogeny" property="og:title">
    <meta content="article" property="og:type">
    <meta content="https://simply-jekyll.netlify.app//notes/basics_of_clonal_evolution" property="og:url"><title>Notes & Thoughts</title>
    <link rel="canonical" href="https://simply-jekyll.netlify.app//notes/basics_of_clonal_evolution"/>
    <link rel="apple-touch-icon" href="/assets/img/profile.png">
    <link rel="icon" href="/assets/img/favicon.png" type="image/png" sizes="16x16"/>
    <link href="/assets/css/Style.css" rel="stylesheet" media="all" class="default" />
    <link href="/assets/css/Util.css" rel="stylesheet" media="all" class="default" />
    <link href="/assets/css/vendor/Katex.css" rel="stylesheet" media="all" class="default"/>
    <!--[if IE]>
      <link href="/assets/css/ie-target.css" rel="stylesheet" type="text/css"/>
    <![endif]-->
    <!--<link href="/assets/css/prism.css" rel="stylesheet" />-->
    <link rel="alternate" type="application/rss+xml" href="https://simply-jekyll.netlify.app//feed.xml">
  </head>
  <body>
    <div class="container">
      <div class = "box">
        <header>
          <div class="dashboard disable-select">
            <div class="site-heading-ltr profile-board-col">
              <p class="main-page-heading medium margin-top-30"><a href='/'>Notes & Thoughts</a></p>
            </div>
          </div>
          <div class="main-site-subheader menu disable-select">
            <a class="menu-item" href="/about">
              <svg class="menu-item-icon" width="18" height="19" viewBox="0 0 25 25" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                <path
                        d="M20.9777 21.6138V19.6138C20.9777 18.553 20.5563 17.5356 19.8061 16.7854C19.056 16.0353 18.0386 15.6138 16.9777 15.6138H8.97768C7.91682 15.6138 6.8994 16.0353 6.14926 16.7854C5.39911 17.5356 4.97768 18.553 4.97768 19.6138V21.6138"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  <path
                        d="M12.9777 11.6138C15.1868 11.6138 16.9777 9.82298 16.9777 7.61385C16.9777 5.40471 15.1868 3.61385 12.9777 3.61385C10.7685 3.61385 8.97768 5.40471 8.97768 7.61385C8.97768 9.82298 10.7685 11.6138 12.9777 11.6138Z"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                  <p class="menu-item-text">About</p>
                </a>
                <a class="menu-item" href="/tags">
                  <svg class="menu-item-icon" width="18" height="19" viewBox="0 0 24 25" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 9.5H20" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M4 15.5H20" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M10 3.5L8 21.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M16 3.5L14 21.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                  <p class="menu-item-text">Tags</p>
                </a>
                <a class="menu-item" href="/feed.xml">
                  <svg class="menu-item-icon" width="18" height="19" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 11.5C6.38695 11.5 8.67613 12.4482 10.364 14.136C12.0518 15.8239 13 18.1131 13 20.5"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M4 4.5C8.24346 4.5 12.3131 6.18571 15.3137 9.18629C18.3143 12.1869 20 16.2565 20 20.5"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path
                        d="M5 20.5C5.55228 20.5 6 20.0523 6 19.5C6 18.9477 5.55228 18.5 5 18.5C4.44772 18.5 4 18.9477 4 19.5C4 20.0523 4.44772 20.5 5 20.5Z"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <p class="menu-item-text">RSS</p>
                  </a>
                </div>
                <div class="searchbar search-container">
                  <svg class="search-icon" width="19" height="19" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M11.5 19.5C15.9183 19.5 19.5 15.9183 19.5 11.5C19.5 7.08172 15.9183 3.5 11.5 3.5C7.08172 3.5 3.5 7.08172 3.5 11.5C3.5 15.9183 7.08172 19.5 11.5 19.5Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M21.5 21.5L17.15 17.15"  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <div class="search-shortcut disable-select">
                    <kbd class="disable-select">Shift</kbd>
                    <kbd class="disable-select">s</kbd>
                  </div>
                  <label for="search-input"></label>
                  <input type="text" id="search-input" autocomplete="off" placeholder="Search Notes & Thoughts..."/>
                  <div id="search-results" class="search-results"></div>
                </div>
                <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script>
                <script src="/assets/js/Search.js"></script>
                <div class="main-site-subheader disable-select" id="scroll-head">
                  <div class="back-icon" onclick="window.location.assign('/');">
                    <svg class="ripple" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24">
                      <path d="M0 0h24v24H0z" fill="none"/>
                      <path d="M21 11H6.83l3.58-3.59L9 6l-6 6 6 6 1.41-1.41L6.83 13H21z"/>
                    </svg>
                  </div>
                  <p class="back-p">Home</p>
                </div>
              </header>
              <main>
                <h1>Basics of Phylogeny</h1>
                <!-- Parse internal links, external links, transclusions etc and manipuate the content to reflect it accordingly -->
                <ul class="tags">
                  <li><a href="/dates/#13-August-2020" class="tag">August-13-2020</a></li>
                  <!-- Loop through page categories and print them in tags -->
                  <li><a href="/tags/#notes" class="tag">notes</a></li>
                  <li><a href="/tags/#mixphy" class="tag">mixphy</a></li>
                  <li><a href="/tags/#clonefinder" class="tag">clonefinder</a></li>
                  <li><a href="/tags/#phylogeny" class="tag">phylogeny</a></li>
                  <li><a href="/tags/#main" class="tag">main</a></li>
                </ul>
                <div class="content">
                  <h1 id="phylogeny">Phylogeny</h1>
                  <p>Given a VAFs, the task is to generate ancestoral tree such that it adheres to the principles of perfect phylogeny.</p>
                  <h2 id="terminology">Terminology</h2>
                  <ul>
                    <li>M matrix of size $(m, n)$ denotes the presence of $m^{th}$ mutation in $n^{th}$ location of the tumor.</li>
                    <li>V matrix of size $(m, n)$ represents VAFs of $m^{th}$ sample in $n^{th}$ location of the tumor.</li>
                    <li>T tree, provides the ancestoral representation of mutations based on phylogeny of M matrix.</li>
                    <li>Character, represents the language of mutation and in our case T or A denoting whether Tumor has been found at a particular site or not.</li>
                  </ul>
                  <h2 id="perfect-phylogeny">Perfect Phylogeny</h2>
                  <blockquote>
                    <p>A phylogeny tree is perfect if it follows the following principle,</p>
                  </blockquote>
                  <ul>
                    <li>Mathematically, there should be no conflict between the mutations at any two sites.</li>
                  </ul>
                  \[Conflict (i, j) = 
                  \begin{cases}
                  true, &amp; \text{} M[k, j] \nleqslant M[k, i], M[k, j] \ngeqslant M[k, i], \forall k \in m.  \\
                  &amp;\text{} M[k, j] = M[k, i], \exists k \in m.  \\
                  false, &amp; otherwise
                  \end{cases}\]
                  <p>$\quad$ for example,</p>
                  \[M = \begin{bmatrix}
                  1&amp;0&amp;0&amp;0\\
                  1&amp;1&amp;1&amp;0\\
                  0&amp;0&amp;0&amp;1\\
                  0&amp;1&amp;0&amp;0
                  \end{bmatrix}\]
                  <p>$\quad$ Column 1 and 2 in Matrix, M are in conflict while column 3 and 4 are not.</p>
                  <ul>
                    <li>
                      <p>Intutively, it is because we can say that that column 3 is ancestoral clone of column 2 but we cant say the same for column 1 and 2. While with column 3 and 4, we can say these are not ancestoral clones.</p>
                    </li>
                    <li>
                      <p>Perfect Phylogeny, also ensures the invention of new character<a class="citation" href="#vingron2003algorithms">[1]</a> is a rare events and does not happen in multiple sites across the phylogeny tree.</p>
                    </li>
                  </ul>
                  <h3 id="generation-of-evolutionary-tree-from-perfect-phylogeny">Generation of Evolutionary tree from Perfect Phylogeny</h3>
                  <p>Given M, which has no conflict present in the columns, finding ancestors required as to</p>
                  <div class="highlighter-rouge">
                    <div class="highlight">
                      <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre>
                    </td>
                    <td class="rouge-code">
                      <pre>Input : M

function(map)

function(M):
    sort(M) over columns.
    append($C_0$, M), where $C_0 \in \{0\}.$ 
    for $C, C'$ in columns, where $C' \ne C$:
        if $C' \subseteq C$ then
            draw an edge in T from $C \to C'$;
    

    for each_node in T:
        get(characters required)
        check : any row uses these characters
        if yes:
            label node as that row.
</pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </code></pre>
        </div>
      </div>
      <p>Example:</p>
      \[M = \begin{bmatrix}
      0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1\\
      0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0\\
      0&amp;0&amp;0&amp;0&amp;1&amp;1&amp;0\\
      0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0\\
      0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0\\
      0&amp;1&amp;1&amp;0&amp;0&amp;0&amp;0\\
      1&amp;1&amp;1&amp;0&amp;0&amp;0&amp;0
      \end{bmatrix},
      M_{sorted} = 
      \begin{bmatrix}
      1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1\\
      1&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0\\
      1&amp;0&amp;0&amp;1&amp;0&amp;0&amp;1&amp;0\\
      1&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0\\
      1&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\
      1&amp;1&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0\\
      1&amp;1&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0
      \end{bmatrix}\]
      <table>
        <thead>
          <tr>
            <th><img src="../assets/imgs/phylogeny_m_inpt.png" alt="" /></th>
            <th><img src="../assets/imgs/columns_decomposition.png" alt="" /></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Tree with nodes representing columns</td>
            <td>Tree with nodes representing mutation, and Yellow color nodes representing derived mutation</td>
          </tr>
        </tbody>
      </table>
      <h2 id="importance-of-vafs-in-phylogeny">Importance of VAFs in phylogeny</h2>
      <table>
        <thead>
          <tr>
            <th><img src="../assets/imgs/phylogeny_vaf_inpt.png" alt="" /></th>
            <th><img src="../assets/imgs/vaf_columns_decomposition.png" alt="" /></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Tree with nodes representing columns</td>
            <td>Tree with nodes representing mutation, and Yellow color nodes representing derived mutation</td>
          </tr>
        </tbody>
      </table>
      <p>When we added VAFs information to the mutations, we were able to infer inner relationship between the nodes which got lost with binary representation of M matrix.</p>
      <h2 id="maximum-parsimony">Maximum Parsimony</h2>
      <ul>
        <li>In real world experiments, we are not gurranteed to get perfect phylogeny from the sequencing, and that’s where the principle of maximum parsimony plays its role.</li>
        <li>Our aim is to generate parsimonious tree from the input data, i.e. a tree which can represent the M matrix in the best possible representation.</li>
        <li>Algorithm (It uses distance based clustering for generation of tree, and Fitcher’s small parsimony principle for labeling of derived clones)
          <div class="language-java highlighter-rouge">
            <div class="highlight">
              <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">0
1
2
3
</pre>
            </td>
            <td class="rouge-code">
              <pre>      <span class="nc">Create</span> <span class="n">a</span> <span class="n">separate</span> <span class="n">cluster</span> <span class="k">for</span> <span class="n">each</span> <span class="n">node</span><span class="o">.</span>
      <span class="nf">Iteratively</span><span class="o">(</span><span class="n">till</span> <span class="n">we</span> <span class="n">have</span> <span class="n">only</span> <span class="n">one</span> <span class="n">cluster</span> <span class="n">left</span><span class="o">):</span>
          <span class="nc">Given</span> <span class="n">all</span> <span class="n">of</span> <span class="n">the</span> <span class="n">clusters</span><span class="o">,</span>
          <span class="n">merge</span> <span class="n">two</span> <span class="n">clusters</span> <span class="n">which</span> <span class="n">has</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">distance</span><span class="o">.</span>
</pre>
            </td>
          </tr>
        </tbody>
      </table>
    </code></pre>
</div>
    </div>
<p>where</p>
\[distance(a, b) = \frac{distance(a) + distance(b)}{2},\]
<p>and initial distance between two clones are calculated as the edit distance between two clones.</p>
<div class="highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre>
  </td>
  <td class="rouge-code">
    <pre>      Given : Tree
      At first,
          In bottom up fashion, for each location(k) of node i,$$
          Cn_i^k = \begin{cases}
          \cup(Cn_j^k) &amp; if \cap(Cn_j^k) = \phi, where\ n_j = child(n_i)\\
          \cap(Cn_j^k) &amp; otherwise\\
          \end{cases}
          $$
          In the top down fashion, for each location(k) of node i,$$
              Cn_i^k = \begin{cases}
              Cn_i^k = Cn_j^k &amp; if Cn_j^k \in Cn_i^k, where\ n_j^k = parent(n_i^k)\\
              Cn_i^k = random(Cn_i^k, 1) &amp; otherwise
              \end{cases}
          $$

</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
    </div>
</li>
</ul>
<h2 id="mixphy">MixPhy</h2>
<ul>
  <li>With Fletcher’s Algorithm and Agglomerative clustering, we aimed to find the best parsimonious tree from the M but it does not takes into the account key factors that clones in M might have been mixed.</li>
  <li>That’s where the problem of Maximum parsimony comes into account. The problem states that we have to find the best steiner tree from the input M.</li>
  <li>MixPhy solved this Np-hard problem heuristically by restructing the input as a perfect graph and coloring rows which will get split into multiple clones.</li>
  <li>Algorithm
    <ul>
      <li>For the given M, create a graph, G in which two columns are connected if either one is contained in another.
        where, contained is defined as if all of the element are either $\leq$ or $\geq$.</li>
      <li>As the containment is a transitive in nature,</li>
      <li>i.e. if {0, 0, 1} is contained in {0, 1, 1} and {0, 1, 1} is contained in {1, 1, 1} then {0, 0, 1} is also contained in {1, 1, 1}</li>
      <li>Thus the output graphs becomes perfect in nature, and the problem of finding cliques becomes polynomially complex.</li>
      <li>If we observe the complement of G is the conflict graph in which any two columns are connected if both are conflicting in nature.</li>
      <li>Thus coloring a clique of graph G, with the same color will lead to no two adjacent columns having the same color in the conflict graph.</li>
      <li>and for each row in M:
        if color of all of the mutated column is same, then we do not need to split it
        otherwise it will get splitted into k different rows where k are the number of unique colors required to color that row.</li>
    </ul>
  </li>
</ul>
</div>
<!-- Add backlinks to the current page -->
<div class="related show" id="jekyll-seamless-relatedposts">
  <h4 class="medium-small">Related Posts</h4>
  <div class="related-wrapper">
    <div class="related-group"><a href="/notes/basics_of_probability">
        <p class="related-title">Points to study</p>
        <p class="related-excerpt">
          Machine Learning
          Lecture 1
          Hypothesis Testing
          Density Estimation
          Multi Instance Lear...</p>
      </a></div>
    <div class="related-group"><a href="/notes/basics_of_probability">
        <p class="related-title">Basics of Probability</p>
        <p class="related-excerpt">Probability
          Measure of a subset under relation pretex
          Basic Terms
          Sample Space, Event, Proper Subset, Disjoint, Event Space,
          Event s...</p>
      </a></div>
    <div class="related-group"><a href="/notes/study-of-colorization">
        <p class="related-title">Colorization - Sampling Color from GrayScale and I.R. Images</p>
        <p class="related-excerpt">Given a grayscale image, it is a daunting task, even for a human, to visualize it in color. See Figure 1 for examples. However, a human m...</p>
      </a></div>
    <div class="related-group"><a href="/notes/tree_metrics_in_detail">
        <p class="related-title">How does tree metrics works</p>
        <p class="related-excerpt">Comparing MLTED, RF distance, and TreeVec
          MLTED
          Tree 1
          Tree 2
          ...</p>
      </a></div>
    <div class="related-group"><a href="/notes/xAI/intro">
        <p class="related-title">Introduction to Explainable AI</p>
        <p class="related-excerpt">Paper - 1, Measuring the Quality of Explanations: The System Causability Scale
          With the current advancements in Machine Learning, and...</p>
      </a></div>
  </div>
  <br/>
</div>
</main>
<div id="copyright">
  <p id="copyright-notice">© Karan Dhingra. 2022</p>
</div>
</div>
</div>
<!-- Load KaTeX --></body>
</html>